<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CodeGen Pro - QR Code Generator</title>
<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
<style>
:root {
--primary: #6366f1;
--primary-dark: #4f46e5;
--secondary: #10b981;
--light: #f8fafc;
--dark: #1e293b;
--border-radius: 12px;
--shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
}

* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: 'Inter', sans-serif;
}

body {
background: linear-gradient(135deg, #f0f4ff 0%, #f8fafc 100%);
color: var(--dark);
line-height: 1.6;
padding: 2rem;
}

.container {
max-width: 800px;
margin: 0 auto;
background: white;
border-radius: var(--border-radius);
box-shadow: var(--shadow);
padding: 2rem;
}

h1 {
text-align: center;
margin-bottom: 2rem;
color: var(--primary);
}

.app-container {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 2rem;
}

.input-section, .preview-section {
background: var(--light);
padding: 1.5rem;
border-radius: var(--border-radius);
}

.form-group {
margin-bottom: 1.5rem;
}

label {
display: block;
margin-bottom: 0.5rem;
font-weight: 600;
}

input, select, textarea {
width: 100%;
padding: 0.75rem;
border: 1px solid #ddd;
border-radius: var(--border-radius);
font-size: 1rem;
}

input:focus, select:focus {
outline: none;
border-color: var(--primary);
}

.btn {
display: inline-block;
padding: 0.75rem 1.5rem;
background: var(--primary);
color: white;
border: none;
border-radius: var(--border-radius);
font-weight: 600;
cursor: pointer;
transition: all 0.3s ease;
}

.btn:hover {
background: var(--primary-dark);
}

.btn-download {
background: var(--secondary);
width: 100%;
margin-top: 1rem;
}

.qr-container {
width: 250px;
height: 250px;
margin: 1rem auto;
border: 1px solid #eee;
border-radius: var(--border-radius);
display: flex;
align-items: center;
justify-content: center;
background: white;
}

#qrcode {
padding: 10px;
}

.debug-info {
background: #f8f9fa;
padding: 1rem;
border-radius: var(--border-radius);
margin-top: 2rem;
font-family: monospace;
font-size: 0.9rem;
}

@media (max-width: 768px) {
.app-container {
grid-template-columns: 1fr;
}
}
</style>
</head>
<body>
<div class="container">
<h1>QR Code Generator</h1>

<div class="app-container">
<section class="input-section">
<h2>Create QR Code</h2>

<div class="form-group">
<label for="qr-type">Content Type</label>
<select id="qr-type">
<option value="url">Website URL</option>
<option value="text">Plain Text</option>
<option value="email">Email</option>
<option value="phone">Phone Number</option>
<option value="wifi">WiFi Network</option>
</select>
</div>

<div class="form-group">
<label for="qr-content" id="content-label">Website URL</label>
<input type="text" id="qr-content" placeholder="https://example.com" value="https://example.com">
</div>

<div class="form-group">
<label for="qr-size">Size</label>
<select id="qr-size">
<option value="128">Small (128x128)</option>
<option value="256" selected>Medium (256x256)</option>
<option value="400">Large (400x400)</option>
</select>
</div>

<button id="generate-qr-btn" class="btn">Generate QR Code</button>
<button id="test-simple-btn" class="btn" style="background: #666; margin-top: 0.5rem;">Test Simple Generation</button>
</section>

<section class="preview-section">
<h2>QR Code Preview</h2>

<div class="qr-container">
<div id="qrcode"></div>
</div>

<p id="qr-info" style="text-align: center; margin: 1rem 0;">QR code will appear here</p>

<button id="download-qr-btn" class="btn btn-download" disabled>Download QR Code</button>
</section>
</div>

<div class="debug-info">
<h3>Debug Information</h3>
<div id="debug-output">Status: Ready</div>
</div>
</div>

<script>
// Debug logging function
function debugLog(message) {
const debugOutput = document.getElementById('debug-output');
debugOutput.innerHTML += `<br>${new Date().toLocaleTimeString()}: ${message}`;
console.log(message);
}

// QR Code functionality
document.addEventListener('DOMContentLoaded', function() {
debugLog('Page loaded successfully');

const qrType = document.getElementById('qr-type');
const contentLabel = document.getElementById('content-label');
const qrContent = document.getElementById('qr-content');
const qrSize = document.getElementById('qr-size');
const generateQrBtn = document.getElementById('generate-qr-btn');
const testSimpleBtn = document.getElementById('test-simple-btn');
const downloadQrBtn = document.getElementById('download-qr-btn');
const qrCodeContainer = document.getElementById('qrcode');
const qrInfo = document.getElementById('qr-info');

// Test if QRCode library is loaded
debugLog('QRCode library available: ' + (typeof QRCode !== 'undefined'));

// Update placeholder based on QR type
qrType.addEventListener('change', function() {
const type = this.value;
let label = '';
let placeholder = '';

switch(type) {
case 'url':
label = 'Website URL';
placeholder = 'https://example.com';
break;
case 'text':
label = 'Text Content';
placeholder = 'Enter your text here';
break;
case 'email':
label = 'Email Address';
placeholder = 'example@email.com';
break;
case 'phone':
label = 'Phone Number';
placeholder = '+1 (123) 456-7890';
break;
case 'wifi':
label = 'WiFi Details';
placeholder = 'WIFI:S:NetworkName;T:WPA;P:Password;;';
break;
}

contentLabel.textContent = label;
qrContent.placeholder = placeholder;
qrContent.value = placeholder;
});

// Test simple QR code generation
testSimpleBtn.addEventListener('click', function() {
debugLog('Testing simple QR code generation...');

// Clear previous QR code
qrCodeContainer.innerHTML = '';

// Generate simple test QR code
try {
QRCode.toCanvas(qrCodeContainer, 'https://google.com', {
width: 128,
margin: 1,
color: {
dark: '#000000',
light: '#FFFFFF'
}
}, function(error) {
if (error) {
debugLog('Simple test error: ' + error);
qrInfo.textContent = 'Error generating QR code';
} else {
debugLog('Simple test successful!');
qrInfo.textContent = 'Simple test QR code generated';
downloadQrBtn.disabled = false;
}
});
} catch (e) {
debugLog('Exception in simple test: ' + e.message);
}
});

// Generate QR code
generateQrBtn.addEventListener('click', function() {
const content = qrContent.value.trim();
const size = parseInt(qrSize.value);

debugLog(`Generating QR code - Content: "${content}", Size: ${size}`);

if (!content) {
alert('Please enter content for the QR code');
return;
}

// Clear previous QR code
qrCodeContainer.innerHTML = '';

// Format content based on type
let formattedContent = content;
const type = qrType.value;

switch(type) {
case 'email':
formattedContent = `mailto:${content}`;
break;
case 'phone':
formattedContent = `tel:${content}`;
break;
case 'wifi':
// WiFi format: WIFI:S:SSID;T:Type;P:Password;;
if (!content.startsWith('WIFI:')) {
formattedContent = content; // Assume already formatted
}
break;
}

debugLog(`Formatted content: ${formattedContent}`);

try {
// Generate QR code using toCanvas method
QRCode.toCanvas(qrCodeContainer, formattedContent, {
width: size,
height: size,
margin: 1,
color: {
dark: '#000000',
light: '#FFFFFF'
},
errorCorrectionLevel: 'M'
}, function(error) {
if (error) {
debugLog('QR Code generation error: ' + error);
qrInfo.textContent = 'Error generating QR code: ' + error.message;

// Try alternative method
try {
debugLog('Trying alternative generation method...');
QRCode.toString(formattedContent, {
width: size,
margin: 1,
color: {
dark: '#000000',
light: '#FFFFFF'
}
}, function(err, string) {
if (err) {
debugLog('Alternative method also failed: ' + err);
} else {
debugLog('Alternative method successful');
qrCodeContainer.innerHTML = string;
qrInfo.textContent = 'QR code generated (SVG)';
downloadQrBtn.disabled = false;
}
});
} catch (e) {
debugLog('Alternative method exception: ' + e.message);
}
} else {
debugLog('QR code generated successfully!');
qrInfo.textContent = 'QR code generated successfully';
downloadQrBtn.disabled = false;
}
});
} catch (e) {
debugLog('Exception in QR code generation: ' + e.message);
qrInfo.textContent = 'Exception: ' + e.message;
}
});

// Download QR code
downloadQrBtn.addEventListener('click', function() {
const canvas = qrCodeContainer.querySelector('canvas');
if (!canvas) {
alert('Please generate a QR code first');
return;
}

try {
const link = document.createElement('a');
link.download = 'qrcode.png';
link.href = canvas.toDataURL('image/png');
link.click();
debugLog('QR code downloaded successfully');
} catch (e) {
debugLog('Download error: ' + e.message);
alert('Error downloading QR code: ' + e.message);
}
});

// Generate initial sample QR code
debugLog('Generating initial sample QR code...');
setTimeout(() => {
QRCode.toCanvas(qrCodeContainer, 'https://example.com', {
width: 200,
margin: 1,
color: {
dark: '#000000',
light: '#FFFFFF'
}
}, function(error) {
if (error) {
debugLog('Initial sample error: ' + error);
} else {
debugLog('Initial sample generated successfully');
qrInfo.textContent = 'Sample QR code loaded';
downloadQrBtn.disabled = false;
}
});
}, 1000);
});
</script>
</body>
</html>
